<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>

<style>
    
    * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            display: flex;
        flex-direction: column;
        min-height: 100vh;
        background: #e3e6e4;
        }

      /* barra navegadora*/

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(90deg, #2c3e50, #34495e); /* Nuevo color */
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: sticky;
        top: 0;
        width: 100%;
        z-index: 10;
        }

        .logo {
            font-size: 1.8em;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            color: #ffcc00; /* Color dorado */
        }

        .nav-links {
            list-style: none;
            display: flex;
            gap: 20px;
        }

        .nav-links li {
            text-transform: uppercase;
        }

        .nav-links a {
            text-decoration: none;
            color: white;
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: color 0.3s, background-color 0.3s;
            padding: 5px 10px;
            border-radius: 5px;
        }

        .nav-links a:hover {
            background-color: #f39c12; /* Color de fondo al pasar el ratón */
        }

        .nav-links a.active {
            background-color: #f39c12; /* Color al estar activo */
            color: white;
        }

        .burger {
            display: none;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
        }

        .burger div {
            width: 25px;
            height: 3px;
            background-color: white;
            transition: transform 0.3s;
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
                flex-direction: column;
                gap: 10px;
                background-color: #2c3e50;
                position: absolute;
                top: 60px;
                right: 0;
                padding: 20px;
                border-radius: 8px;
            }

            .burger {
                display: flex;
            }
        }
 /* barra navegadora_final */


     /* Barra lateral derecha */

     .sidebar {
        position: fixed;
        top: 96px;
        left: 0;
        width: 200px;
        height: calc(100% - 60px);
        background-color: #34495e;
        color: white;
        padding: 20px;
        box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
        
    }

    .user-info {
        text-align: center;
        margin-bottom: 30px;
    }

    .user-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        margin-bottom: 10px;
    }

    .user-name {
        font-weight: bold;
        margin-bottom: 5px;
    }

    .user-role {
        font-size: 0.9em;
        margin-bottom: 10px;
    }

    .sidebar-links {
        list-style: none;
        padding: 0;
    }

    .sidebar-links li {
        margin: 15px 0;
    }

    .sidebar-links a {
        color: white;
        text-decoration: none;
        font-size: 1.1em;
        transition: color 0.3s;
    }

    .sidebar-links a:hover {
        color: #f39c12;
    }
  


     /* Barra lateral derecha_final */    

     .main-content {
        display: flex;
        flex-direction: column;
        flex-grow: 1;
        padding: 10px;
        margin-left: 200px; /* Espacio para el sidebar */
    }
        
        
        



    /* estilos calendario */
	#cal { 
        padding: 0px; 
	    -moz-box-shadow:0px 3px 3px rgba(0, 0, 0, 0.25); 
	    -webkit-box-shadow:0px 3px 3px rgba(0, 0, 0, 0.25); 
	    margin:50px auto; 
	    font: 13px/1.5 "Helvetica Neue", Helvatica, Arial, san-serif; 
	    display:table; 
	}
    #cal .header { 
	    cursor:default; 
	    background: #cd310d; 
	    background: -moz-linear-gradient(top, #b32b0c, #cd310d); 
	    background: -webkit-gradient(linear, left top, left bottom, from(#b32b0c), to(#cd310d)); 
	    height: 34px; 
	    position: relative; 
	    color:#fff; 
	    -webkit-border-top-left-radius: 5px; 
	    -webkit-border-top-right-radius: 5px; 
	    -moz-border-radius-topleft: 5px; 
	    -moz-border-radius-topright: 5px; 
	    border-top-left-radius: 5px; 
	    border-top-right-radius: 5px; 
	    font-weight:bold; 
	    text-shadow:0px -1px 0 #87260C; 
	    text-transform: uppercase; 
	} 
	#cal .header span { 
	    display:inline-block; 
	    line-height:34px; 
	}
    #cal .header .hook { 
	    width: 9px; 
	    height: 28px; 
	    position: absolute; 
	    bottom:60%; 
	    border-radius:10px; 
	    -moz-border-radius:10px; 
	    -webkit-border-radius:10px; 
	    background:#ececec; 
	    background: -moz-linear-gradient(right top, #fff, #827e7d); 
	    background: -webkit-gradient(linear, right top, right bottom, from(#fff), to(#827e7d)); 
	    box-shadow:0px -1px 2px rgba(0, 0, 0, 0.65 ); 
	    -moz-box-shadow:0px -1px 2px rgba(0, 0, 0, 0.65 ); 
	    -webkit-box-shadow:0px -1px 2px rgba(0, 0, 0, 0.65 ); 
	} 
	.right.hook { 
	    right:15%; 
	} 
	.left.hook { 
	    left: 15%; 
	}
    #cal .header .button { 
	    width:24px; 
	    text-align:center; 
	    position:absolute; 
	} 
	#cal .header .left.button { 
	    left:0; 
	    -webkit-border-top-left-radius: 5px; 
	    -moz-border-radius-topleft: 5px; 
	    border-top-left-radius: 5px; 
	    border-right:1px solid #ae2a0c; 
	} 
	#cal .header .right.button { 
	    right:0; 
	    top:0; 
	    border-left:1px solid #ae2a0c; 
	    -webkit-border-top-right-radius: 5px; 
	    -moz-border-radius-topright: 5px; 
	    border-top-right-radius: 5px; 
	} 
	#cal .header .button:hover { 
	    background: -moz-linear-gradient(top, #f34ace, #f54ae7); 
	    background: -webkit-gradient(linear, left top, left bottom, from(#ee31de), to(#f038f0)); 
	}
    #cal .header .month-year { 
	    letter-spacing: 1px; 
	    width: 100%; 
	    text-align: center; 
	}


    #cal table { 
        
	    background:#fff; 
	    border-collapse:collapse; 
	} 
	#cal td { 
	    color:#2b2b2b; 
	    width:40px; 
	    height:40px; 
	    line-height:30px; 
	    text-align:center; 
	    /*border:1px solid #e6e6e6; */
	    cursor:default; 
        border-radius: 1px; /* redondear la celda*/
        font-weight: 400;
        text-shadow: 0px 0px 1px rgba(0, 0, 0, 0.1); /* Simulación de grosor */
        transition: all 0.3s ease;
	} 
	#cal #days td { 
	    height:26px; 
	    line-height: 26px; 
	    text-transform:uppercase; 
	    font-size:90%; 
	    color:#9e9e9e; 
        
	} 
	#cal #days td:not(:last-child) { 
	    border-right:1px solid #fff; 
	}

    /* tabla citas */
    .tabla-citas {
        width: 100%;
        border-collapse: collapse;
        font-family: Arial, sans-serif;
        margin: 40px 0;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        overflow: hidden;
        border-radius: 8px;
    }

    .tabla-citas thead {
        background: linear-gradient(to right, #007bff, #28a745);
        color: #ffffff;
        text-transform: uppercase;
        font-size: 14px;
        font-weight: bold;
    }

    .tabla-citas thead th {
        padding: 12px;
        text-align: center;
        border-right: 1px solid rgba(255, 255, 255, 0.2);
    }

    .tabla-citas thead th:last-child {
        border-right: none;
    }

    .tabla-citas tbody tr {
        background: #f8f9fc;
        border-bottom: 1px solid #e3e6f0;
        transition: background 0.2s;
    }

    .tabla-citas tbody tr:hover {
        background: #f1f3f6;
    }

    .tabla-citas tbody td {
        padding: 10px;
        text-align: center;
        color: #5a5c69;
        
    }

    .container1 {
    position: relative; /* Contenedor para el sidebar */
}

/* estilo boton selecionar cita */
.boton-seleccionar {
    background-color: #1e7220; /* Color de fondo */
    color: white;             /* Color del texto */
    border: none;             /* Sin borde */
    padding: 10px 20px;       /* Espaciado interno */
    text-align: center;       /* Centrado del texto */
    font-size: 16px;          /* Tamaño de fuente */
    cursor: pointer;          /* Cambia el cursor al pasar el mouse */
    border-radius: 5px;       /* Bordes redondeados */
    transition: background-color 0.3s ease; /* Transición suave */
}

.boton-seleccionar:hover {
    background-color: #65df6b; /* Color al pasar el mouse */
}

/* mensaje no hay citas*/
.divmensaje {
    display: none; /* Por defecto, ocultar */
    background-color: #f9f9f9; /* Fondo claro */
    color: #333;              /* Texto oscuro */
    border: 2px solid #4CAF50; /* Borde verde */
    border-radius: 10px;       /* Bordes redondeados */
    padding: 20px;             /* Espaciado interno */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Sombra */
    font-family: 'Arial', sans-serif; /* Fuente moderna */
    font-size: 18px;           /* Tamaño de texto */
    max-width: 400px;          /* Ancho máximo */
    margin: 20px auto;         /* Centrado horizontal */
    text-align: center;        /* Texto centrado */
    animation: aparecer 0.5s ease-out; /* Animación al aparecer */
}

.divmensaje:not(:empty) {
    display: block; /* Mostrar solo cuando no esté vacío */


}


/* circulos disponibilidad*/
    .legend {
    position: absolute; /* Permite posicionar libremente el div */
    top: 230px; /* Ajusta según la posición vertical deseada */
    left: 240px; /* Ajusta según la posición horizontal deseada */
    display: flex;
    flex-direction: column; /* Organiza los elementos en columna */
    gap: 15px; /* Espacio entre las filas de la leyenda */
    font-family: Arial, sans-serif;
    font-size: 14px;
}

.legend-item {
    display: flex;
    align-items: center; /* Alinea círculo y texto en la misma línea */
    gap: 10px; /* Espacio entre el círculo y el texto */
}

.circle {
    width: 20px;
    height: 20px;
    border-radius: 5%;
    flex-shrink: 0; /* Evita que el círculo se deforme */
}

.circle.red {
    background-color: rgb(202, 200, 200);/*d3d2d1*/
}

.circle.blue {
    background-color: rgb(119, 208, 243);
}
.circle.white {
    background-color: rgb(255, 255, 255);
}





</style>
<body>
    <div class="container1">
        <!-- navegador -->
        <div class="divnavbar">
            <nav class="navbar">
                <div class="logo">
                    <i class="fas fa-clinic-medical"></i> Mi Clínica
                </div>
                <ul class="nav-links">
                    <li><a href="#home" class="active"><i class="fas fa-home"></i> Inicio</a></li>
                    <li><a href="#about"><i class="fas fa-info-circle"></i> Acerca de</a></li>
                    <li><a href="#services"><i class="fas fa-briefcase"></i> Servicios</a></li>
                    <li><a href="#contact"><i class="fas fa-envelope"></i> Contacto</a></li>
                    <!-- Enlace con ícono para cerrar sesión -->
                    <li><a href="#logout"><i class="fas fa-sign-out-alt"></i> Cerrar sesión</a></li>
                </ul>
                <div class="burger">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </nav>


        </div>

        <!-- navegador_final -->

        
        <!-- menu_lateral-->
        <div class="sidebar">
            <div class="user-info">

                <img src="C:\Users\Hnas_Perez_Ramos\Desktop\html\Proyecto_citas_medicas\logo2.png" alt="Foto de Usuario" class="user-avatar">
                <p class="user-name" id="nombreUsuario">Juan Pérez</p>
                <p class="user-role">Usuario</p>
                <i class="fas fa-male"></i> <!-- Cambia esto por <i class="fas fa-female"></i> para mujer -->
            </div>
            <ul class="sidebar-links">
                <li><a href="#profile">Mi Perfil</a></li>
                <li><a href="#appointments">Mis Citas</a></li>
                <li><a href="#settings">Configuración</a></li>
            </ul>
        </div>
        <div class="legend">
            <div class="legend-item">
                <div class="circle red"></div>
                <span>Sin citas</span>
            </div>
            <div class="legend-item">
                <div class="circle blue"></div>
                <span>Con citas</span>
            </div>
            <div class="legend-item">
                <div class="circle white"></div>
                <span>Sin Programacion</span>
            </div>
        </div>>
       
    </div>  
    
   

     
     <!-- Menu_lateral_final-->

    


    <!-- botones para ir a otras paginas
    <div>
        <button class="regresarButton" onclick="window.location.href = '02_Login.html';">
            Regresar a Inicio
        </button>  

        <button class="regresarcraercitas" onclick="window.location.href = '03_Crearcitas.html';">
            Regresar a citas
        </button> 
    </div> -->
        
        <!-- tabla calendario-->

    <div class="main-content">  
            <div  id="cal"class="calendarios">

                <div class="header"> 
                    <span class="left button" id="prev"> &lang; </span> 
                    <span class="left hook"></span> 
                    <span class="month-year" id="label"> Diciembre 2024 </span> 
                    <span class="right hook"></span> 
                    <span class="right button" id="next"> &rang; </span>
              
                </div>
                <div>
                    <table>  
                        <thead id="">
                        
                                <tr>
                                    <th>Dom</th>
                                    <th>Lun</th>
                                    <th>Mar</th>
                                    <th>Mier</th>
                                    <th>Jue</th>
                                    <th>Vie</th>
                                    <th>sab</th>
                                </tr>
                            
                        </thead>
                        <tbody id="calendario">

                        </tbody>
                        
                    </table>          

                </div>
              
                

            </div> 

           
           
            <!-- tabla calendario final-->


                <!-- tabla citas-->
            <div clas="divtablacitas">
                <table  class="tabla-citas" >
                    <thead> 
                        <tr>
                            <th>id</th>
                            <th>Fecha</th>
                            <th>Hora</th>
                            <th>Nombre</th>
                            <th>Apellido</th>
                            <th>Estado</th>
                            <th>Accion</th>
                        </tr>
                    </thead> 
                    <tbody id="citasusuarios">

                    </tbody>    

                </table>
            </div>
                <!-- tabla citas final-->

            <div class="divmensaje">
                <p id="Nohaycitas"></p>
            </div>
   
    </div>        
    
</body>
<script>


const fechaActual = new Date();
const diaActual = fechaActual.getDate();
console.log("hoy",diaActual);
let year = 2024;
let month = fechaActual.getMonth() + 1;// Inicialmente, el mes es diciembre
let mesActual=month;

// Actualizar al cargar la página y al redimensionar el sidebar barra lateral que cambia de posicion
const mensajeDiv = document.querySelector('.divmensaje');       

document.addEventListener('DOMContentLoaded', () => {
            const navbar = document.querySelector('.navbar');
            const sidebar = document.querySelector('.sidebar');

            function updateSidebarTop() {
                const navbarHeight = navbar.offsetHeight; // Altura dinámica de la barra de navegación
                sidebar.style.top = `${navbarHeight}px`; // Asigna el valor dinámico
            }

    // Actualizar al cargar la página y al redimensionar
    updateSidebarTop();
    window.addEventListener('resize', updateSidebarTop);
    // fianal
});

    // esto es del navegador//
    const burger = document.querySelector('.burger');
        const navLinks = document.querySelector('.nav-links');
        const navItems = document.querySelectorAll('.nav-links a');

        burger.addEventListener('click', () => {
            navLinks.classList.toggle('nav-active');
        });

        navItems.forEach(item => {
            item.addEventListener('click', () => {
                navItems.forEach(link => link.classList.remove('active')); // Elimina la clase 'active' de todas las pestañas
                item.classList.add('active'); // Añade la clase 'active' a la pestaña clicada
            });
        });;

    //final 


    let citascreadas;
    let username;
    let password;
    let identificacionglobal;
    let nombreglobal;
    let datosCitas ;

    //window.addEventListener('load', function() {
        // Recuperar el usuario desde localStorage
        citascreadas = localStorage.getItem("citascreadas");
        console.log("probando_recibir1",citascreadas);
        //console.log("probando_recibir",citascreadas);

        if (citascreadas) {
            // Convertir el JSON a objeto
            datosCitas = JSON.parse(citascreadas);
            //console.log("probando_recibir1",datosCitas);
           

            // Cargar los datos del usuario en variables
            //username = user.username;
            //password = user.password;
            //identificacionglobal=user.identificacionglobal;
            //nombreglobal=user.nombreglobal;

            // Usar los datos del usuario como necesites
            //console.log("Usuario:", username);
            //console.log("Contraseña:", password);

            // Puedes mostrar el nombre de usuario en la página, por ejemplo:
            //document.getElementById("welcomeMessage").textContent = `Bienvenido, ${username}!`;
        } else {
            // Si no hay usuario en localStorage, redirigir a la página de login
            //window.location.href = "login.html";
            console.log(" no hay citas");
        }
   // });
   // Ojo este codigo fue realizado por mi//

   //console.log("usuario",username,password,identificacionglobal,nombreglobal)    
    

    //const datosCitas = [];

    /*let year=2024;
    let month=12;
    let day=12;




    const resultado = document.getElementById('calendario');
    const fechaActual = new Date();
    //fechaActual.setMonth(10);
    const primerDiaDelMes = new Date(fechaActual.getFullYear(), fechaActual.getMonth(), 1);
    const diaSemana = fechaActual.getDay();
    const dia1mesactual = primerDiaDelMes.getDay();
    const diaultimomesactual=new Date(fechaActual.getFullYear(), fechaActual.getMonth() + 1,0);
    const ultimoDiames = diaultimomesactual.getDate();
    const formatearfecha= fechaActual.toLocaleDateString() + " " + diaSemana
    const compensaciondiasmes=ultimoDiames+dia1mesactual;
    //document.getElementById('mostrar').textContent = dia1mesactual;

    for( let i=0; i < compensaciondiasmes;i++){
        const crearfilacelda=document.createElement("tr");
        resultado.appendChild(crearfilacelda);

        
        for(let j=0; j < 7; j++){
            i=i+1;
            if(i>compensaciondiasmes){
                break;
            }
            else if(i > dia1mesactual){
                //k=k+1
                const crearcelda=document.createElement("td");
                crearcelda.textContent=((i-dia1mesactual));
                resultado.appendChild(crearcelda);
            }
            else{
                const crearcelda=document.createElement("td");
                crearcelda.textContent=(" ") ;
                resultado.appendChild(crearcelda);
            }
        }

            i=i-1;
    }



    const tabla2 = document.getElementById("calendario");
        // Seleccionamos todas las celdas de la tabla con id "tabla2"
        const celdasTabla2 = tabla2.querySelectorAll("td");

        // Añadimos el listener para cada celda de "tabla2"
        celdasTabla2.forEach(function(celda) {
            celda.addEventListener("click", capturarClicCelda);
        });*/

    actualizarColoresCalendario();    

    function actualizarColoresCalendario(celdaActual) {
        const celdasTabla = document.querySelectorAll('#calendario td');
    //console.log("consultar<-colores", datosCitas);
    
    const celdaActual2=celdaActual;
    console.log("celda_actual", celdaActual2);
    
    celdasTabla.forEach(celda => {
        const dia = celda.textContent.trim();
        if(dia===celdaActual)return;
        if (!dia) return; // Ignorar celdas vacías

        const fecha = `${year}-${String(month).padStart(2, '0')}-${String(dia).padStart(2, '0')}`;
        const citasDelDia = datosCitas.filter(cita => cita.fecha === fecha && dia >= diaActual);//borrar esto para que se vean los colores en todas la celdas

        if (citasDelDia.length === 0) {
            // No hay citas en esta fecha
            //celda.style.backgroundColor = "white"; // Sin color para fechas sin citas
        } else if (citasDelDia.every(cita => cita.estado === "Seleccionada")) {
            celda.style.backgroundColor = "#cdd4d9"; // "#cdd4d9"Gris si todas las citas están seleccionadas
            //console.log("Todas las citas están seleccionadas en:", fecha);
            celda.style.boxShadow = "inset -2px -2px 5px #c4c4c4, inset 2px 2px 5px #ffffff";
            celda.style.transform = "translateY(-1px)";
        } else if (citasDelDia.some(cita => cita.estado === "Disponible")) {
            celda.style.backgroundColor = "#4bc9ff"; // Azul si hay citas disponibles
            celda.style.boxShadow = "inset -2px -2px 5px #d4d4d4, inset 2px 2px 5px #ffffff";
            celda.style.transform = "translateY(-1px)";
        } else {
            //celda.style.backgroundColor = ""; // Sin color si no hay citas
        }
    });
    
    }





const resultado = document.getElementById('calendario');
const label = document.getElementById('label'); // Elemento para mostrar el mes y año


// Función para actualizar el calendario
function actualizarCalendario() {
    // Limpiar el calendario actual
    resultado.innerHTML = '';

    // Mostrar el mes y el año en el encabezado
    const meses = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
    label.textContent = `${meses[month - 1]} ${year}`;

    // Crear el primer día del mes
    const primerDiaDelMes = new Date(year, month - 1, 1);
    const diaSemana = primerDiaDelMes.getDay(); // Día de la semana del 1° día del mes
    const ultimoDiaDelMes = new Date(year, month, 0).getDate(); // Último día del mes

    // Calcular el número de filas necesarias
    let diaContador = 1;
    const filasNecesarias = Math.ceil((diaSemana + ultimoDiaDelMes) / 7); // Número de filas según el número de días

    // Crear las filas para el calendario
    for (let i = 0; i < filasNecesarias; i++) {
        const fila = document.createElement("tr");
        for (let j = 0; j < 7; j++) {
            const celda = document.createElement("td");

            if (i === 0 && j < diaSemana) {
                // Espacios vacíos antes del primer día del mes
                celda.textContent = '';
            } else if (diaContador <= ultimoDiaDelMes) {
                // Colocar los días del mes
                celda.textContent = diaContador;

                //instruccion para cambia de color las celdas inferiores a fecha actual

                 if (diaContador < diaActual && month==mesActual) { // Cambia 10 por el número que desees
                celda.style.color = "#dfdedc"}
                else{
                    celda.style.cursor = 'pointer';
                };

                celda.addEventListener("click", capturarClicCelda); // Agregar el evento para cada celda
                diaContador++;
            }
            fila.appendChild(celda);
        }
        resultado.appendChild(fila);
    }

    // Actualizar los colores según las citas
    actualizarColoresCalendario();
}
        
    
   /* function capturarClicCelda(event) {

            // Accedemos al contenido de la celda clickeada
            const contenido = event.target.innerText;
            console.log("click", event);
            const celdas = document.querySelectorAll("td");  // Selecciona todas las celdas de la tabla
            celdas.forEach(function(celda) {
            celda.style.backgroundColor = ""; 
            celda.style.boxShadow = "";// Elimina el color de fondo de todas las celdas
            limpiarCitasCreadas();
            
            
    });
            event.target.style.backgroundColor = "#cdd4d9";
            event.target.style.boxShadow = "inset -2px -2px 5px #c4c4c4, inset 2px 2px 5px #ffffff";
            event.target.style.transform = "translateY(-1px)";
            //alert("Has hecho clic en la celda con el contenido: " + contenido);
            const date = `${year}-${String(month).padStart(2, '0')}-${String(contenido).padStart(2, '0')}`;
            //document.getElementById('Fecha').value = date;
            //mostrarconclick(date);
            mostrarUsuariosconclick(date);
            actualizarColoresCalendario(); 
            
            
        }
    */

    function capturarClicCelda(eventOrDay) {
    let contenido;

    // Verificar si es un evento o un número (día específico)
    if (eventOrDay instanceof Event) {
        // Si es un evento (clic), obtenemos el contenido del clic
        contenido = eventOrDay.target.innerText;
       // console.log("aqui1")
    } else {
        // Si es un número, lo usamos directamente como el día
        contenido = eventOrDay;
        //console.log("aqui2")
    }

    // Asegurarse de que 'contenido' no esté vacío o inválido
    if (!contenido) return;

    //console.log("Día seleccionado:", contenido);

    const celdas = document.querySelectorAll("td");  // Selecciona todas las celdas de la tabla
    //console.log("celdastodas",celdas)
    celdas.forEach(function(celda) {
        celda.style.backgroundColor = ""; 
        celda.style.boxShadow = ""; // Elimina el color de fondo de todas las celdas
    });

    limpiarCitasCreadas(); // Llamada para limpiar las citas creadas, si es necesario

    // Si se pasó un número (día específico), buscamos la celda correspondiente
    if (typeof contenido === 'number') {
        const celda = Array.from(celdas).find(c => parseInt(c.innerText) === contenido && month==mesActual);
        if (celda) {
            // Aplicamos los estilos a la celda correspondiente al número
            celda.style.backgroundColor = "lime";//gris elegante "#cdd4d9";
            celda.style.boxShadow = "inset -2px -2px 5px #c4c4c4, inset 2px 2px 5px #ffffff";
            celda.style.transform = "translateY(-1px)";
        } else {
            console.log(`No se encontró la celda con el día ${contenido}`);
        }
    } else {
        // Si es un clic (evento), aplicamos los estilos al elemento clickeado
        eventOrDay.target.style.backgroundColor = "lime";
        eventOrDay.target.style.boxShadow = "inset -2px -2px 5px #c4c4c4, inset 2px 2px 5px #ffffff";
        eventOrDay.target.style.transform = "translateY(-1px)";
    }

    // Crear la fecha con el formato adecuado (Año-Mes-Día)
    const date = `${year}-${String(month).padStart(2, '0')}-${String(contenido).padStart(2, '0')}`;
    
    // Aquí puedes manejar el proceso de mostrar usuarios o actualizar el calendario
    mostrarUsuariosconclick(date);
    actualizarColoresCalendario(contenido); 
}

    function mostrarUsuariosconclick(date) {
    //console.log("probando", identificacionglobal);
    //console.log("probandofecha", date);

    // Crear un nuevo array que incluya tanto los datos como el índice original
    const citasConIndices = datosCitas
        .map((cita, index) => ({ ...cita, index }))
        .filter(cita => cita.fecha === date && cita.estado === "Disponible");

    if (citasConIndices.length === 0) {
       // console.log("Cita no encontrada", datosCitas);
       document.getElementById('Nohaycitas').textContent="¡ No hay citas disponible para este dia !"
       mensajeDiv.style.display = 'block'; // Muestra el cuadro
    } 
    else {
        mensajeDiv.style.display = 'none';
        document.getElementById('Nohaycitas').textContent="";
        const resultado2 = document.getElementById('citasusuarios');
        resultado2.innerHTML = ""; // Limpiar tabla anterior
        
        citasConIndices.forEach(function(cita) {
            const diaExtraido = cita.fecha.split('-')[2];
            console.log("probandoindex", diaExtraido,diaActual);
            if(diaExtraido>=diaActual){//instruccion para desactivar el cargue de citas en fechas anteriores a la actual
            const fila = document.createElement("tr");

            const celdaid = document.createElement("td");
            //celdaid.textContent = cita.id;
            celdaid.textContent = identificacionglobal;
            fila.appendChild(celdaid);

            const celdafecha = document.createElement("td");
            celdafecha.textContent = cita.fecha;
            fila.appendChild(celdafecha);

            const celdahora = document.createElement("td");
            celdahora.textContent = cita.hora;
            fila.appendChild(celdahora);

            const celdanombre = document.createElement("td");
            celdanombre.textContent = cita.nombre;
            fila.appendChild(celdanombre);

            const celdapellido = document.createElement("td");
            celdapellido.textContent = cita.apellido;
            fila.appendChild(celdapellido);

            const celdaestado = document.createElement("td");
            celdaestado.textContent = cita.estado;
            fila.appendChild(celdaestado);

            const celdaccion = document.createElement("td");
            const boton = document.createElement("button");
            boton.textContent = "seleccionar";
            boton.className = "boton-seleccionar"; // Asigna una clase
            boton.onclick = () =>
                seleccionarcita(cita.index, date, celdanombre, fila, boton, cita.estado);
            celdaccion.appendChild(boton);
            fila.appendChild(celdaccion);

            resultado2.appendChild(fila);
            }//hace parte para desactivar cargar citas en dias precios al dia actual
            else{ 
                //hace parte para desactivar cargar citas en dias precios al dia actual
                console.log("aqui..aqui")
                
                document.getElementById('Nohaycitas').textContent="¡ No hay citas disponible para este dia !"    
                mensajeDiv.style.display = 'block'; // Muestra el cuadro  
            };//hace parte para desactivar cargar citas en dias precios al dia actual

        });
    
    }
}

    function limpiarCitasCreadas() {
            //const resultado = document.getElementById('citascreadas');
            //const resultado2 = document.getElementById('citasusuarios');
            //console.log("Datos de citas:", resultado.firstElementChild);
           

            
                 
            //document.getElementById('citascreadas').innerHTML = "";
            document.getElementById('citasusuarios').innerHTML = "";
            //const tablaCitasCreadas = document.getElementById('citascreadas');
            //while (tablaCitasCreadas.firstChild) {
            //tablaCitasCreadas.removeChild(tablaCitasCreadas.firstChild);
        }
        
    function seleccionarcita(index, date,celdanombre, fila, boton,celdaestado) {
        // Cambiar el estado de la cita a "Seleccionada"
        
        //console.log("entrada",boton);
        //console.log("entradadatos",index,date,celdanombre,fila,boton,celdaestado);
        //datosCitas[index].estado = "Seleccionada";
        if (datosCitas[index].fecha === date && datosCitas[index].estado === "Disponible") {
        // Cambiar el estado a "Seleccionada"
        datosCitas[index].estado = "Seleccionada";
        datosCitas[index].id = identificacionglobal;
        //datosCitas[index].nombre = nombreglobal;
    }
        //console.log("Cita actualizada:", datosCitas[index]);
        
        


        // Actualizar visualmente el botón y la fila

        //boton.textContent = "Cancelar";
        //boton.onclick = () => cancelarCita(index, date, fila, boton);

        // Eliminar la fila de la tabla de citas disponibles
        fila.remove();
        localStorage.setItem("citascreadas", JSON.stringify(datosCitas));
        //console.log("probando_salidaguardar",datosCitas);

        //console.log("Estado actualizado:", datosCitas);
    }   


    // Eventos para las flechas de navegación
document.getElementById('prev').addEventListener('click', () => {

    const mesLabel = document.getElementById('label');
    // Cambiar al mes anterior
    
    if (month!==mesActual){
        if (month === 1) {
            month = 12;
            year--;
        } else {
            month--;
        }
    }
        actualizarCalendario();
        capturarClicCelda(diaActual);
});

document.getElementById('next').addEventListener('click', () => {
    // Cambiar al siguiente mes
    if (month === 12) {
        month = 1;
        year++;
    } else {
        month++;
    }
    actualizarCalendario();
});


document.addEventListener('DOMContentLoaded', actualizarCalendario);

//Instrucion para capturar el dia ctual y coloarlo en gris en el calendario//
document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
       capturarClicCelda(diaActual); // Llama a tu función después del retraso
    }, 10); // Retraso en milisegundos (2000 ms = 2 segundos)
});


    

</script>
</html>

